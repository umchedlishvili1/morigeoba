<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>áƒ›áƒáƒ áƒ˜áƒ’áƒ”áƒáƒ‘áƒ˜áƒ¡ áƒ’áƒáƒœáƒ áƒ˜áƒ’áƒ˜</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        h2 { color: #2c3e50; margin-bottom: 20px; }
        .container { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 600px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #3498db; color: white; border-radius: 4px 4px 0 0; }
        tr:hover { background-color: #f1f1f1; }
        .loading { text-align: center; color: #7f8c8d; font-style: italic; }
        .status { font-size: 0.8em; margin-top: 10px; color: #27ae60; }
    </style>
</head>
<body>

    <h2>ğŸ“… áƒ›áƒáƒ áƒ˜áƒ’áƒ”áƒáƒ‘áƒ˜áƒ¡ áƒ’áƒáƒœáƒ áƒ˜áƒ’áƒ˜</h2>

    <div class="container">
        <table>
            <thead>
                <tr>
                    <th>áƒ¡áƒáƒ®áƒ”áƒšáƒ˜</th>
                    <th>áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜</th>
                    <th>áƒªáƒ•áƒšáƒ</th>
                </tr>
            </thead>
            <tbody id="schedule-body">
                <tr>
                    <td colspan="3" class="loading">áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ áƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ‘áƒ...</td>
                </tr>
            </tbody>
        </table>
        <div id="update-status" class="status"></div>
    </div>

    <script>
        // áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ•áƒáƒœáƒ˜: áƒ©áƒáƒ¡áƒ•áƒ˜ áƒ¨áƒ”áƒœáƒ˜ "Publish to web" CSV áƒ‘áƒ›áƒ£áƒšáƒ˜ áƒáƒ¥ áƒ‘áƒ áƒ­áƒ§áƒáƒšáƒ”áƒ‘áƒ¨áƒ˜
        const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ90YrfyI8dpgnB5x73UA_gDHP2DI_MQ8AA0RqwoTZPQXppRTeDCIdWCg9Gm66Vk4L-WX42cC1zIo9N/pubhtml";

        async function loadData() {
            try {
                const response = await fetch(sheetURL);
                const data = await response.text();
                
                // CSV-áƒ¡ áƒ“áƒáƒ›áƒ£áƒ¨áƒáƒ•áƒ”áƒ‘áƒ
                const rows = data.split('\n').map(row => row.split(','));
                const tableBody = document.getElementById('schedule-body');
                const statusDiv = document.getElementById('update-status');
                
                tableBody.innerHTML = ""; // áƒ’áƒáƒ¡áƒ£áƒ¤áƒ—áƒáƒ•áƒ”áƒ‘áƒ

                // áƒáƒ˜áƒ áƒ•áƒ”áƒš áƒ®áƒáƒ–áƒ¡ (áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ”áƒ‘áƒ¡) áƒ•áƒ¢áƒáƒ•áƒ”áƒ‘áƒ—, áƒ•áƒ˜áƒ¬áƒ§áƒ”áƒ‘áƒ— áƒ›áƒ”áƒáƒ áƒ”áƒ“áƒáƒœ (i=1)
                for (let i = 1; i < rows.length; i++) {
                    if (rows[i][0] && rows[i][0].trim() !== "") {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td><strong>${rows[i][0]}</strong></td>
                            <td>${rows[i][1] || '-'}</td>
                            <td>${rows[i][2] || '-'}</td>
                        `;
                        tableBody.appendChild(tr);
                    }
                }
                
                const now = new Date();
                statusDiv.innerText = "áƒ‘áƒáƒšáƒáƒ¡ áƒ’áƒáƒœáƒáƒ®áƒšáƒ“áƒ: " + now.toLocaleTimeString();

            } catch (error) {
                document.getElementById('schedule-body').innerHTML = "<tr><td colspan='3' style='color:red;'>áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ˜áƒ¡áƒáƒ¡.</td></tr>";
                console.error("Error:", error);
            }
        }

        // áƒáƒ•áƒ¢áƒáƒ›áƒáƒ¢áƒ£áƒ áƒ˜ áƒ’áƒáƒœáƒáƒ®áƒšáƒ”áƒ‘áƒ áƒ§áƒáƒ•áƒ”áƒš 5 áƒ¬áƒ£áƒ—áƒ¨áƒ˜ (300000 áƒ›áƒ˜áƒšáƒ˜áƒ¬áƒáƒ›áƒ˜)
        loadData();
        setInterval(loadData, 300000);
    </script>
</body>
</html>